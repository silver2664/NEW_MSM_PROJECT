<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="goodsMapper">

<!-- 01. 상품 전체 목록 -->
<select id = "listProduct" resultType = "com.project.goods.vo.GoodsVO">
	SELECT	MGNUM, MGNAME, MGPRICE, MGCONTENT, MGIMG
	FROM EX_GOODS
	ORDER BY MGNUM DESC
</select>

<!-- 02. 상품 상세 보기
<select id = "detailProduct" resultType = "com.project.goods.vo.GoodsVO">
	SELECT MGNUM, MGNAME, MGPRICE, MGCONTENT, MGIMG ,MGSTOCK,CATECODE
	FROM EX_GOODS
	WHERE MGNUM = #{mgNum}
</select> -->

<!-- 03. 상품 등록 -->
<insert id="register">
		INSERT INTO EX_GOODS  (MGNUM,MGNAME,MGPRICE,MGSTOCK,MGCONTENT,MGIMG,MGTHUMBIMG,CATECODE)
			VALUES (PRODUCT_SEQ.nextval,#{mgName},#{mgPrice},#{mgStock},#{mgContent},#{mgImg},#{mgThumbImg},#{cateCode})
</insert>

<!-- 상품수정  -->
<update id="productModify" parameterType="com.project.goods.vo.GoodsVO">

	UPDATE EX_GOODS
	SET 
	MGNAME= #{mgName},
	MGPRICE = #{mgPrice},
	MGSTOCK =#{mgStock},
	MGIMG = #{mgImg},
	MGCONTENT = #{mgContent},
	CATECODE = #{cateCode}
	WHERE MGNUM = #{mgNum}
</update>

<!-- 상품삭제 -->
<delete id="productDelete">
	DELETE EX_GOODS
	WHERE MGNUM = #{mgNum}
</delete>

<!-- 카테고리 호출 -->
<select id="category" resultType="com.project.goods.vo.CategoryVO">
	select level, cateName,cateCode,cateCodeRef
	 from goods_category
	Start with cateCodeRef is null connect by prior cateCode = cateCodeRef
			
</select>

<!-- 상품 조회 + 카테고리 조인 -->
<select id="goodsView" resultType="com.project.goods.vo.GoodsViewVO">
	SELECT 
		G.MGNUM, G.MGNAME, C.CATECODEREF,C.CATENAME, MGPRICE, MGCONTENT, MGIMG ,MGSTOCK,G.CATECODE
		FROM EX_GOODS G
			INNER JOIN GOODS_CATEGORY C
				ON G.CATECODE = C.CATECODE
			WHERE MGNUM = #{mgNum}
</select>

<!-- 카테고리 리스트 -->
<select id="cateList" resultType="com.project.goods.vo.GoodsViewVO">
	select
    g.mgNum, g.mgName,g.cateCode,c.cateCodeRef,c.cateName,mgPrice,mgStock,mgContent,g.mgImg
    from ex_goods g
            inner join goods_category c
                on g.cateCode = c.cateCode
                where g.cateCode = #{cateCode}
</select>

</mapper>